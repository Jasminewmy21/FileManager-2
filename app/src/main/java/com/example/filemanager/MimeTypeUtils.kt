package com.example.filemanager

import android.content.Context
import android.content.Intent
import android.net.Uri
import java.io.File

/**
 * Created by Zeyang on 2020-6-5.
 */
enum class MimeTypeUtils {
    instance;

    fun shareSingleFile(context: Context, file: File) {
        val intent = Intent(Intent.ACTION_SEND)
        val mimeType = getMIMEType(file.path)
        intent.type = mimeType
        val uri = Uri.fromFile(file)
        intent.putExtra(Intent.EXTRA_STREAM, uri)
        context.startActivity(Intent.createChooser(intent, context.getString(R.string.menu_share)))
    }

    /**
     * 获取文件类型
     *
     * @param filePath 文件路径
     */
    fun getMIMEType(filePath: String): String {
        var type = "*/*"
        val dotIndex = filePath.lastIndexOf(".")
        if (dotIndex < 0) {
            return type
        }
        val end = filePath.substring(dotIndex, filePath.length).toLowerCase()
        if (end == "") {
            return type
        }
        for (i in MIME_MapTable.indices) {
            if (end == MIME_MapTable[i][0]) {
                type = MIME_MapTable[i][1]
            }
        }
        return type
    }

    companion object {
        /**
         * MIME 列表
         */
        private val MIME_MapTable = arrayOf(arrayOf(".3gp", "video/3gpp"), arrayOf(".3gpp", "video/3gpp"), arrayOf(".aac", "audio/x-mpeg"), arrayOf(".amr", "audio/x-mpeg"), arrayOf(".apk", "application/vnd.android.package-archive"), arrayOf(".avi", "video/x-msvideo"), arrayOf(".aab", "application/x-authoware-bin"), arrayOf(".aam", "application/x-authoware-map"), arrayOf(".aas", "application/x-authoware-seg"), arrayOf(".ai", "application/postscript"), arrayOf(".aif", "audio/x-aiff"), arrayOf(".aifc", "audio/x-aiff"), arrayOf(".aiff", "audio/x-aiff"), arrayOf(".als", "audio/X-Alpha5"), arrayOf(".amc", "application/x-mpeg"), arrayOf(".ani", "application/octet-stream"), arrayOf(".asc", "text/plain"), arrayOf(".asd", "application/astound"), arrayOf(".asf", "video/x-ms-asf"), arrayOf(".asn", "application/astound"), arrayOf(".asp", "application/x-asap"), arrayOf(".asx", " video/x-ms-asf"), arrayOf(".au", "audio/basic"), arrayOf(".avb", "application/octet-stream"), arrayOf(".awb", "audio/amr-wb"), arrayOf(".bcpio", "application/x-bcpio"), arrayOf(".bld", "application/bld"), arrayOf(".bld2", "application/bld2"), arrayOf(".bpk", "application/octet-stream"), arrayOf(".bz2", "application/x-bzip2"), arrayOf(".bin", "application/octet-stream"), arrayOf(".bmp", "image/bmp"), arrayOf(".c", "text/plain"), arrayOf(".class", "application/octet-stream"), arrayOf(".conf", "text/plain"), arrayOf(".cpp", "text/plain"), arrayOf(".cal", "image/x-cals"), arrayOf(".ccn", "application/x-cnc"), arrayOf(".cco", "application/x-cocoa"), arrayOf(".cdf", "application/x-netcdf"), arrayOf(".cgi", "magnus-internal/cgi"), arrayOf(".chat", "application/x-chat"), arrayOf(".clp", "application/x-msclip"), arrayOf(".cmx", "application/x-cmx"), arrayOf(".co", "application/x-cult3d-object"), arrayOf(".cod", "image/cis-cod"), arrayOf(".cpio", "application/x-cpio"), arrayOf(".cpt", "application/mac-compactpro"), arrayOf(".crd", "application/x-mscardfile"), arrayOf(".csh", "application/x-csh"), arrayOf(".csm", "chemical/x-csml"), arrayOf(".csml", "chemical/x-csml"), arrayOf(".css", "text/css"), arrayOf(".cur", "application/octet-stream"), arrayOf(".doc", "application/msword"), arrayOf(".docx", "application/vnd.openxmlformats-officedocument.wordprocessingml.document"), arrayOf(".dcm", "x-lml/x-evm"), arrayOf(".dcr", "application/x-director"), arrayOf(".dcx", "image/x-dcx"), arrayOf(".dhtml", "text/html"), arrayOf(".dir", "application/x-director"), arrayOf(".dll", "application/octet-stream"), arrayOf(".dmg", "application/octet-stream"), arrayOf(".dms", "application/octet-stream"), arrayOf(".dot", "application/x-dot"), arrayOf(".dvi", "application/x-dvi"), arrayOf(".dwf", "drawing/x-dwf"), arrayOf(".dwg", "application/x-autocad"), arrayOf(".dxf", "application/x-autocad"), arrayOf(".dxr", "application/x-director"), arrayOf(".ebk", "application/x-expandedbook"), arrayOf(".emb", "chemical/x-embl-dl-nucleotide"), arrayOf(".embl", "chemical/x-embl-dl-nucleotide"), arrayOf(".eps", "application/postscript"), arrayOf(".epub", "application/epub+zip"), arrayOf(".eri", "image/x-eri"), arrayOf(".es", "audio/echospeech"), arrayOf(".esl", "audio/echospeech"), arrayOf(".etc", "application/x-earthtime"), arrayOf(".etx", "text/x-setext"), arrayOf(".evm", "x-lml/x-evm"), arrayOf(".evy", "application/x-envoy"), arrayOf(".exe", "application/octet-stream"), arrayOf(".fh4", "image/x-freehand"), arrayOf(".fh5", "image/x-freehand"), arrayOf(".fhc", "image/x-freehand"), arrayOf(".fif", "image/fif"), arrayOf(".fm", "application/x-maker"), arrayOf(".fpx", "image/x-fpx"), arrayOf(".fvi", "video/isivideo"), arrayOf(".flv", "video/x-msvideo"), arrayOf(".gau", "chemical/x-gaussian-input"), arrayOf(".gca", "application/x-gca-compressed"), arrayOf(".gdb", "x-lml/x-gdb"), arrayOf(".gif", "image/gif"), arrayOf(".gps", "application/x-gps"), arrayOf(".gtar", "application/x-gtar"), arrayOf(".gz", "application/x-gzip"), arrayOf(".gif", "image/gif"), arrayOf(".gtar", "application/x-gtar"), arrayOf(".gz", "application/x-gzip"), arrayOf(".h", "text/plain"), arrayOf(".hdf", "application/x-hdf"), arrayOf(".hdm", "text/x-hdml"), arrayOf(".hdml", "text/x-hdml"), arrayOf(".htm", "text/html"), arrayOf(".html", "text/html"), arrayOf(".hlp", "application/winhlp"), arrayOf(".hqx", "application/mac-binhex40"), arrayOf(".hts", "text/html"), arrayOf(".ice", "x-conference/x-cooltalk"), arrayOf(".ico", "application/octet-stream"), arrayOf(".ief", "image/ief"), arrayOf(".ifm", "image/gif"), arrayOf(".ifs", "image/ifs"), arrayOf(".imy", "audio/melody"), arrayOf(".ins", "application/x-NET-Install"), arrayOf(".ips", "application/x-ipscript"), arrayOf(".ipx", "application/x-ipix"), arrayOf(".it", "audio/x-mod"), arrayOf(".itz", "audio/x-mod"), arrayOf(".ivr", "i-world/i-vrml"), arrayOf(".j2k", "image/j2k"), arrayOf(".jad", "text/vnd.sun.j2me.app-descriptor"), arrayOf(".jam", "application/x-jam"), arrayOf(".jnlp", "application/x-java-jnlp-file"), arrayOf(".jpe", "image/jpeg"), arrayOf(".jpz", "image/jpeg"), arrayOf(".jwc", "application/jwc"), arrayOf(".jar", "application/java-archive"), arrayOf(".java", "text/plain"), arrayOf(".jpeg", "image/jpeg"), arrayOf(".jpg", "image/jpeg"), arrayOf(".js", "application/x-javascript"), arrayOf(".kjx", "application/x-kjx"), arrayOf(".lak", "x-lml/x-lak"), arrayOf(".latex", "application/x-latex"), arrayOf(".lcc", "application/fastman"), arrayOf(".lcl", "application/x-digitalloca"), arrayOf(".lcr", "application/x-digitalloca"), arrayOf(".lgh", "application/lgh"), arrayOf(".lha", "application/octet-stream"), arrayOf(".lml", "x-lml/x-lml"), arrayOf(".lmlpack", "x-lml/x-lmlpack"), arrayOf(".log", "text/plain"), arrayOf(".lsf", "video/x-ms-asf"), arrayOf(".lsx", "video/x-ms-asf"), arrayOf(".lzh", "application/x-lzh "), arrayOf(".m13", "application/x-msmediaview"), arrayOf(".m14", "application/x-msmediaview"), arrayOf(".m15", "audio/x-mod"), arrayOf(".m3u", "audio/x-mpegurl"), arrayOf(".m3url", "audio/x-mpegurl"), arrayOf(".ma1", "audio/ma1"), arrayOf(".ma2", "audio/ma2"), arrayOf(".ma3", "audio/ma3"), arrayOf(".ma5", "audio/ma5"), arrayOf(".man", "application/x-troff-man"), arrayOf(".map", "magnus-internal/imagemap"), arrayOf(".mbd", "application/mbedlet"), arrayOf(".mct", "application/x-mascot"), arrayOf(".mdb", "application/x-msaccess"), arrayOf(".mdz", "audio/x-mod"), arrayOf(".me", "application/x-troff-me"), arrayOf(".mel", "text/x-vmel"), arrayOf(".mi", "application/x-mif"), arrayOf(".mid", "audio/midi"), arrayOf(".midi", "audio/midi"), arrayOf(".m4a", "audio/mp4a-latm"), arrayOf(".m4b", "audio/mp4a-latm"), arrayOf(".m4p", "audio/mp4a-latm"), arrayOf(".m4u", "video/vnd.mpegurl"), arrayOf(".m4v", "video/x-m4v"), arrayOf(".mov", "video/quicktime"), arrayOf(".mp2", "audio/x-mpeg"), arrayOf(".mp3", "audio/x-mpeg"), arrayOf(".mp4", "video/mp4"), arrayOf(".mpc", "application/vnd.mpohun.certificate"), arrayOf(".mpe", "video/mpeg"), arrayOf(".mpeg", "video/mpeg"), arrayOf(".mpg", "video/mpeg"), arrayOf(".mpg4", "video/mp4"), arrayOf(".mpga", "audio/mpeg"), arrayOf(".msg", "application/vnd.ms-outlook"), arrayOf(".mif", "application/x-mif"), arrayOf(".mil", "image/x-cals"), arrayOf(".mio", "audio/x-mio"), arrayOf(".mmf", "application/x-skt-lbs"), arrayOf(".mng", "video/x-mng"), arrayOf(".mny", "application/x-msmoney"), arrayOf(".moc", "application/x-mocha"), arrayOf(".mocha", "application/x-mocha"), arrayOf(".mod", "audio/x-mod"), arrayOf(".mof", "application/x-yumekara"), arrayOf(".mol", "chemical/x-mdl-molfile"), arrayOf(".mop", "chemical/x-mopac-input"), arrayOf(".movie", "video/x-sgi-movie"), arrayOf(".mpn", "application/vnd.mophun.application"), arrayOf(".mpp", "application/vnd.ms-project"), arrayOf(".mps", "application/x-mapserver"), arrayOf(".mrl", "text/x-mrml"), arrayOf(".mrm", "application/x-mrm"), arrayOf(".ms", "application/x-troff-ms"), arrayOf(".mts", "application/metastream"), arrayOf(".mtx", "application/metastream"), arrayOf(".mtz", "application/metastream"), arrayOf(".mzv", "application/metastream"), arrayOf(".nar", "application/zip"), arrayOf(".nbmp", "image/nbmp"), arrayOf(".nc", "application/x-netcdf"), arrayOf(".ndb", "x-lml/x-ndb"), arrayOf(".ndwn", "application/ndwn"), arrayOf(".nif", "application/x-nif"), arrayOf(".nmz", "application/x-scream"), arrayOf(".nokia-op-logo", "image/vnd.nok-oplogo-color"), arrayOf(".npx", "application/x-netfpx"), arrayOf(".nsnd", "audio/nsnd"), arrayOf(".nva", "application/x-neva1"), arrayOf(".oda", "application/oda"), arrayOf(".oom", "application/x-AtlasMate-Plugin"), arrayOf(".ogg", "audio/ogg"), arrayOf(".pac", "audio/x-pac"), arrayOf(".pae", "audio/x-epac"), arrayOf(".pan", "application/x-pan"), arrayOf(".pbm", "image/x-portable-bitmap"), arrayOf(".pcx", "image/x-pcx"), arrayOf(".pda", "image/x-pda"), arrayOf(".pdb", "chemical/x-pdb"), arrayOf(".pdf", "application/pdf"), arrayOf(".pfr", "application/font-tdpfr"), arrayOf(".pgm", "image/x-portable-graymap"), arrayOf(".pict", "image/x-pict"), arrayOf(".pm", "application/x-perl"), arrayOf(".pmd", "application/x-pmd"), arrayOf(".png", "image/png"), arrayOf(".pnm", "image/x-portable-anymap"), arrayOf(".pnz", "image/png"), arrayOf(".ppt", "application/vnd.ms-powerpoint"), arrayOf(".pps", "application/vnd.ms-powerpoint"), arrayOf(".pot", "application/vnd.ms-powerpoint"), arrayOf(".ppm", "image/x-portable-pixmap"), arrayOf(".pptx", "application/vnd.openxmlformats-officedocument.presentationml.presentation"), arrayOf(".pqf", "application/x-cprplayer"), arrayOf(".pqi", "application/cprplayer"), arrayOf(".prc", "application/x-prc"), arrayOf(".proxy", "application/x-ns-proxy-autoconfig"), arrayOf(".prop", "text/plain"), arrayOf(".ps", "application/postscript"), arrayOf(".ptlk", "application/listenup"), arrayOf(".pub", "application/x-mspublisher"), arrayOf(".pvx", "video/x-pv-pvx"), arrayOf(".qcp", "audio/vnd.qcelp"), arrayOf(".qt", "video/quicktime"), arrayOf(".qti", "image/x-quicktime"), arrayOf(".qtif", "image/x-quicktime"), arrayOf(".r3t", "text/vnd.rn-realtext3d"), arrayOf(".ra", "audio/x-pn-realaudio"), arrayOf(".ram", "audio/x-pn-realaudio"), arrayOf(".ras", "image/x-cmu-raster"), arrayOf(".rdf", "application/rdf+xml"), arrayOf(".rf", "image/vnd.rn-realflash"), arrayOf(".rgb", "image/x-rgb"), arrayOf(".rlf", "application/x-richlink"), arrayOf(".rm", "audio/x-pn-realaudio"), arrayOf(".rmf", "audio/x-rmf"), arrayOf(".rmm", "audio/x-pn-realaudio"), arrayOf(".rnx", "application/vnd.rn-realplayer"), arrayOf(".roff", "application/x-troff"), arrayOf(".rp", "image/vnd.rn-realpix"), arrayOf(".rpm", "audio/x-pn-realaudio-plugin"), arrayOf(".rt", "text/vnd.rn-realtext"), arrayOf(".rte", "x-lml/x-gps"), arrayOf(".rtf", "application/rtf"), arrayOf(".rtg", "application/metastream"), arrayOf(".rtx", "text/richtext"), arrayOf(".rv", "video/vnd.rn-realvideo"), arrayOf(".rwc", "application/x-rogerwilco"), arrayOf(".rar", "application/x-rar-compressed"), arrayOf(".rc", "text/plain"), arrayOf(".rmvb", "audio/x-pn-realaudio"), arrayOf(".s3m", "audio/x-mod"), arrayOf(".s3z", "audio/x-mod"), arrayOf(".sca", "application/x-supercard"), arrayOf(".scd", "application/x-msschedule"), arrayOf(".sdf", "application/e-score"), arrayOf(".sea", "application/x-stuffit"), arrayOf(".sgm", "text/x-sgml"), arrayOf(".sgml", "text/x-sgml"), arrayOf(".shar", "application/x-shar"), arrayOf(".shtml", "magnus-internal/parsed-html"), arrayOf(".shw", "application/presentations"), arrayOf(".si6", "image/si6"), arrayOf(".si7", "image/vnd.stiwap.sis"), arrayOf(".si9", "image/vnd.lgtwap.sis"), arrayOf(".sis", "application/vnd.symbian.install"), arrayOf(".sit", "application/x-stuffit"), arrayOf(".skd", "application/x-Koan"), arrayOf(".skm", "application/x-Koan"), arrayOf(".skp", "application/x-Koan"), arrayOf(".skt", "application/x-Koan"), arrayOf(".slc", "application/x-salsa"), arrayOf(".smd", "audio/x-smd"), arrayOf(".smi", "application/smil"), arrayOf(".smil", "application/smil"), arrayOf(".smp", "application/studiom"), arrayOf(".smz", "audio/x-smd"), arrayOf(".sh", "application/x-sh"), arrayOf(".snd", "audio/basic"), arrayOf(".spc", "text/x-speech"), arrayOf(".spl", "application/futuresplash"), arrayOf(".spr", "application/x-sprite"), arrayOf(".sprite", "application/x-sprite"), arrayOf(".sdp", "application/sdp"), arrayOf(".spt", "application/x-spt"), arrayOf(".src", "application/x-wais-source"), arrayOf(".stk", "application/hyperstudio"), arrayOf(".stm", "audio/x-mod"), arrayOf(".sv4cpio", "application/x-sv4cpio"), arrayOf(".sv4crc", "application/x-sv4crc"), arrayOf(".svf", "image/vnd"), arrayOf(".svg", "image/svg-xml"), arrayOf(".svh", "image/svh"), arrayOf(".svr", "x-world/x-svr"), arrayOf(".swf", "application/x-shockwave-flash"), arrayOf(".swfl", "application/x-shockwave-flash"), arrayOf(".t", "application/x-troff"), arrayOf(".tad", "application/octet-stream"), arrayOf(".talk", "text/x-speech"), arrayOf(".tar", "application/x-tar"), arrayOf(".taz", "application/x-tar"), arrayOf(".tbp", "application/x-timbuktu"), arrayOf(".tbt", "application/x-timbuktu"), arrayOf(".tcl", "application/x-tcl"), arrayOf(".tex", "application/x-tex"), arrayOf(".texi", "application/x-texinfo"), arrayOf(".texinfo", "application/x-texinfo"), arrayOf(".tgz", "application/x-tar"), arrayOf(".thm", "application/vnd.eri.thm"), arrayOf(".tif", "image/tiff"), arrayOf(".tiff", "image/tiff"), arrayOf(".tki", "application/x-tkined"), arrayOf(".tkined", "application/x-tkined"), arrayOf(".toc", "application/toc"), arrayOf(".toy", "image/toy"), arrayOf(".tr", "application/x-troff"), arrayOf(".trk", "x-lml/x-gps"), arrayOf(".trm", "application/x-msterminal"), arrayOf(".tsi", "audio/tsplayer"), arrayOf(".tsp", "application/dsptype"), arrayOf(".tsv", "text/tab-separated-values"), arrayOf(".ttf", "application/octet-stream"), arrayOf(".ttz", "application/t-time"), arrayOf(".txt", "text/plain"), arrayOf(".ult", "audio/x-mod"), arrayOf(".ustar", "application/x-ustar"), arrayOf(".uu", "application/x-uuencode"), arrayOf(".uue", "application/x-uuencode"), arrayOf(".vcd", "application/x-cdlink"), arrayOf(".vcf", "text/x-vcard"), arrayOf(".vdo", "video/vdo"), arrayOf(".vib", "audio/vib"), arrayOf(".viv", "video/vivo"), arrayOf(".vivo", "video/vivo"), arrayOf(".vmd", "application/vocaltec-media-desc"), arrayOf(".vmf", "application/vocaltec-media-file"), arrayOf(".vmi", "application/x-dreamcast-vms-info"), arrayOf(".vms", "application/x-dreamcast-vms"), arrayOf(".vox", "audio/voxware"), arrayOf(".vqe", "audio/x-twinvq-plugin"), arrayOf(".vqf", "audio/x-twinvq"), arrayOf(".vql", "audio/x-twinvq"), arrayOf(".vre", "x-world/x-vream"), arrayOf(".vrml", "x-world/x-vrml"), arrayOf(".vrt", "x-world/x-vrt"), arrayOf(".vrw", "x-world/x-vream"), arrayOf(".vts", "workbook/formulaone"), arrayOf(".wax", "audio/x-ms-wax"), arrayOf(".wbmp", "image/vnd.wap.wbmp"), arrayOf(".web", "application/vnd.xara"), arrayOf(".wav", "audio/x-wav"), arrayOf(".wma", "audio/x-ms-wma"), arrayOf(".wmv", "audio/x-ms-wmv"), arrayOf(".wi", "image/wavelet"), arrayOf(".wis", "application/x-InstallShield"), arrayOf(".wm", "video/x-ms-wm"), arrayOf(".wmd", "application/x-ms-wmd"), arrayOf(".wmf", "application/x-msmetafile"), arrayOf(".wml", "text/vnd.wap.wml"), arrayOf(".wmlc", "application/vnd.wap.wmlc"), arrayOf(".wmls", "text/vnd.wap.wmlscript"), arrayOf(".wmlsc", "application/vnd.wap.wmlscriptc"), arrayOf(".wmlscript", "text/vnd.wap.wmlscript"), arrayOf(".wmv", "video/x-ms-wmv"), arrayOf(".wmx", "video/x-ms-wmx"), arrayOf(".wmz", "application/x-ms-wmz"), arrayOf(".wpng", "image/x-up-wpng"), arrayOf(".wps", "application/vnd.ms-works"), arrayOf(".wpt", "x-lml/x-gps"), arrayOf(".wri", "application/x-mswrite"), arrayOf(".wrl", "x-world/x-vrml"), arrayOf(".wrz", "x-world/x-vrml"), arrayOf(".ws", "text/vnd.wap.wmlscript"), arrayOf(".wsc", "application/vnd.wap.wmlscriptc"), arrayOf(".wv", "video/wavelet"), arrayOf(".wvx", "video/x-ms-wvx"), arrayOf(".wxl", "application/x-wxl"), arrayOf(".x-gzip", "application/x-gzip"), arrayOf(".xar", "application/vnd.xara"), arrayOf(".xbm", "image/x-xbitmap"), arrayOf(".xdm", "application/x-xdma"), arrayOf(".xdma", "application/x-xdma"), arrayOf(".xdw", "application/vnd.fujixerox.docuworks"), arrayOf(".xht", "application/xhtml+xml"), arrayOf(".xhtm", "application/xhtml+xml"), arrayOf(".xhtml", "application/xhtml+xml"), arrayOf(".xls", "application/vnd.ms-excel"), arrayOf(".xlt", "application/vnd.ms-excel"), arrayOf(".xla", "application/vnd.ms-excel"), arrayOf(".xlc", "application/vnd.ms-excel"), arrayOf(".xlm", "application/vnd.ms-excel"), arrayOf(".xlsx", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"), arrayOf(".xlw", "application/vnd.ms-excel"), arrayOf(".xll", "application/x-excel"), arrayOf(".xm", "audio/x-mod"), arrayOf(".xml", "text/xml"), arrayOf(".xmz", "audio/x-mod"), arrayOf(".xpi", "application/x-xpinstall"), arrayOf(".xpm", "image/x-xpixmap"), arrayOf(".xsit", "text/xml"), arrayOf(".xsl", "text/xml"), arrayOf(".xul", "text/xul"), arrayOf(".xwd", "image/x-xwindowdump"), arrayOf(".xyz", "chemical/x-pdb"), arrayOf(".yz1", "application/x-yz1"), arrayOf(".z", "application/x-compress"), arrayOf(".zac", "application/x-zaurus-zac"), arrayOf(".zip", "application/zip"), arrayOf("", "*/*"))
    }
}